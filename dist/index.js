(()=>{var e={922:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,o,a){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(r)for(var c=0;c<this.length;c++){var s=this[c][0];null!=s&&(i[s]=!0)}for(var u=0;u<e.length;u++){var l=[].concat(e[u]);r&&i[l[0]]||(void 0!==a&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=a),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),o&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=o):l[4]="".concat(o)),t.push(l))}},t}},251:e=>{"use strict";e.exports=function(e){var t=e[1],n=e[3];if(!n)return t;if("function"==typeof btoa){var r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),a="/*# ".concat(o," */"),i=n.sources.map((function(e){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(e," */")}));return[t].concat(i).concat([a]).join("\n")}return[t].join("\n")}},424:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(251),o=n.n(r),a=n(922),i=n.n(a)()(o());i.push([e.id,".box {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n  background-size: contain;\r\n  background-position: center;\r\n  background-repeat: no-repeat;\r\n  background-color: rgba(24,144,255,0.5);\r\n}\r\n","",{version:3,sources:["webpack://./src/index.css"],names:[],mappings:"AAAA;EACE,WAAW;EACX,YAAY;EACZ,kBAAkB;EAClB,wBAAwB;EACxB,2BAA2B;EAC3B,4BAA4B;EAC5B,sCAAsC;AACxC",sourcesContent:[".box {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n  background-size: contain;\r\n  background-position: center;\r\n  background-repeat: no-repeat;\r\n  background-color: rgba(24,144,255,0.5);\r\n}\r\n"],sourceRoot:""}]);const c=i},379:e=>{"use strict";var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var a={},i=[],c=0;c<e.length;c++){var s=e[c],u=r.base?s[0]+r.base:s[0],l=a[u]||0,f="".concat(u," ").concat(l);a[u]=l+1;var d=n(f),v={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==d)t[d].references++,t[d].updater(v);else{var h=o(v,r);r.byIndex=c,t.splice(c,0,{identifier:f,updater:h,references:1})}i.push(f)}return i}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var a=r(e=e||[],o=o||{});return function(e){e=e||[];for(var i=0;i<a.length;i++){var c=n(a[i]);t[c].references--}for(var s=r(e,o),u=0;u<a.length;u++){var l=n(a[u]);0===t[l].references&&(t[l].updater(),t.splice(l,1))}a=s}}},569:e=>{"use strict";var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var a=n.sourceMap;a&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},883:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>_});const r=void 0;var o,a=n.n(r);!function(e){e[e.out=0]="out",e[e.in=1]="in",e[e.top_left=2]="top_left",e[e.top_right=3]="top_right",e[e.bottom_right=4]="bottom_right",e[e.bottom_left=5]="bottom_left",e[e.top=6]="top",e[e.right=7]="right",e[e.bottom=8]="bottom",e[e.left=9]="left"}(o||(o={}));var i,c=["default","move","se-resize","sw-resize","se-resize","ne-resize","n-resize","e-resize","n-resize","e-resize"],s=["default","move","default","default","se-resize","default","default","default","default","default"],u=10;function l(e,t,n){return n>e&&n<t}function f(e,t){var n=e.x,r=e.y,a=e.width,i=e.height,c=t.offsetX,s=t.offsetY;return l(n+5,n+a-5,c)&&l(r+5,r+i-5,s)?o.in:l(n-5,n+5,c)&&l(r-5,r+5,s)?o.top_left:l(n+a-5,n+a+5,c)&&l(r-5,r+5,s)?o.top_right:l(n+a-5,n+a+5,c)&&l(r+i-5,r+i+5,s)?o.bottom_right:l(n-5,n+5,c)&&l(r+i-5,r+i+5,s)?o.bottom_left:l(n+5,n+a-5,c)&&l(r-5,r+5,s)?o.top:l(n+a-5,n+a+5,c)&&l(r+5,r+i-5,s)?o.right:l(n+5,n+a-5,c)&&l(r+i-5,r+i+5,s)?o.bottom:l(n-5,n+5,c)&&l(r+5,r+i-5,s)?o.left:o.out}function d(e,t,n,r,o,a,i,c){var s;return e/t>n/r?[(o-(e-n/(s=r/t))/2)*s,a*s,i*s,c*s]:[o*(s=n/e),(a-(t-r/s)/2)*s,i*s,c*s]}!function(e){e[e.out=0]="out",e[e.in=1]="in",e[e.dot=2]="dot"}(i||(i={}));var v=["default","move","e-resize"];const h=function(e){var t,n,o=(0,r.useRef)(null),c=e.src,s=e.canvasWidth,u=e.canvasHeight,l={x:(t=s)/2,y:(n=u)/2,radius:Math.min(.4*t,.4*n,200)/2},f=l.x,h=l.y,p=l.radius,g=(0,r.useState)({x:f,y:h,radius:p}),m=g[0],y=g[1],b=(0,r.useRef)(0),x=(0,r.useState)({x:0,y:0}),w=x[0],E=x[1],R=(0,r.useRef)(!1),M=function(e){o.current&&(o.current.style.cursor=v[e])};function T(){if(o.current){var t=o.current.getContext("2d");if(t){var n=m.x,r=m.y,a=m.radius;t.clearRect(0,0,s,u),t.beginPath(),t.lineTo(0,0),t.arc(n,r,a,0,2*Math.PI),t.lineTo(0,0),t.lineTo(0,u),t.lineTo(s,u),t.lineTo(s,0),t.fillStyle="rgba(0,0,0,0.5)",t.fill(),t.beginPath(),t.arc(n,r,a,0,2*Math.PI),t.stroke(),t.closePath(),t.fillStyle="#F40",t.fillRect(n+a-5,r-5,10,10);var i=document.createElement("canvas");i.width=2*a,i.height=2*a;var l=i.getContext("2d"),f=new Image;f.setAttribute("crossOrigin","anonymous"),f.src=c||"",f.onload=function(){null==l||l.beginPath(),null==l||l.arc(a,a,a,0,2*Math.PI),null==l||l.clip();var t=d(s,u,f.width,f.height,n-a,r-a,2*a,2*a);null==l||l.drawImage(f,t[0],t[1],t[2],t[3],0,0,2*a,2*a),e.onResult(null==i?void 0:i.toDataURL("image/png",1))}}}}(0,r.useEffect)((function(){T()}),[]);var k=function(e,t){var n=m.x,r=m.y,o=m.radius,a=t.nativeEvent,c=a.offsetX,s=a.offsetY;return Math.pow(c-n,2)+Math.pow(s-r,2)<Math.pow(o-5,2)?i.in:c>n+o-5&&c<n+o+5&&s>r-5&&s<r+5?i.dot:i.out};return a().createElement("canvas",{ref:o,width:s,height:u,onMouseDown:function(e){R.current=!0;var t=e.nativeEvent,n=t.offsetX,r=t.offsetY;b.current=k(0,e),M(b.current),E({x:n,y:r})},onMouseEnter:function(e){var t=e.nativeEvent;t.offsetX,t.offsetY},onMouseMove:function(e){if(!R.current){var t=k(0,e);M(t)}if(o.current&&o.current.getContext("2d")){var n=e.nativeEvent,r=n.offsetX,a=n.offsetY;if(b.current>0){var i=m.x,c=m.y,l=m.radius,f=r-w.x,d=a-w.y;1===b.current?(i+=f,c+=d):Math.abs(f)<Math.abs(d)?l+=d:l+=f,l<10&&(l=10),l>Math.min(s,u)/2&&(l=Math.min(s,u)/2),i<l&&(i=l),c<l&&(c=l),i+l>s&&(i=s-l),c+l>u&&(c=u-l),y({x:i,y:c,radius:l}),T(),E({x:r,y:a})}}},onMouseUp:function(e){R.current=!1,b.current=0}})},p=function(e){var t=(0,r.useRef)(null),n=e.src,i=e.canvasWidth,l=e.canvasHeight,v=e.square,h=void 0!==v&&v,p=(0,r.useState)(function(e,t,n){var r=Math.min(200,.4*e),o=Math.min(200,.4*t);return n&&(o=r=Math.min(r,o)),{x:(e-r)/2,y:(t-o)/2,width:r,height:o}}(i,l,h)),g=p[0],m=p[1],y=(0,r.useState)({x:0,y:0}),b=y[0],x=y[1],w=(0,r.useRef)(0),E=(0,r.useRef)(!1);function R(){if(t.current){var r=t.current.getContext("2d");if(r){var o=g.x,a=g.y,c=g.width,s=g.height;r.clearRect(0,0,i,l),r.fillStyle="rgba(0,0,0,0.5)",r.fillRect(0,0,i,l),r.clearRect(o,a,c,s),r.beginPath(),r.setLineDash([0]),r.strokeStyle="#0F0",r.rect(o,a,c,s),r.stroke(),r.beginPath(),r.setLineDash([5]),r.moveTo(o+c/3,a),r.lineTo(o+c/3,a+s),r.moveTo(o+c/3,a),r.lineTo(o+c/3,a+s),r.moveTo(o+2*c/3,a),r.lineTo(o+2*c/3,a+s),r.moveTo(o,a+s/3),r.lineTo(o+c,a+s/3),r.moveTo(o,a+2*s/3),r.lineTo(o+c,a+2*s/3),r.stroke(),r.fillStyle="#F40",h||(r.fillRect(o-5,a-5,u,u),r.fillRect(o+c-5,a-5,u,u),r.fillRect(o-5,a+s-5,u,u),r.fillRect(o+c/2-5,a-5,u,u),r.fillRect(o-5,a+s/2-5,u,u),r.fillRect(o+c/2-5,a+s-5,u,u),r.fillRect(o+c-5,a+s/2-5,u,u)),r.fillRect(o+c-5,a+s-5,u,u),r.closePath();var f=document.createElement("canvas");f.width=c,f.height=s;var v=f.getContext("2d"),p=new Image;p.setAttribute("crossOrigin","anonymous"),p.src=n||"",p.onload=function(){var t=d(i,l,p.width,p.height,o,a,c,s);null==v||v.drawImage(p,t[0],t[1],t[2],t[3],0,0,c,s),e.onResult(null==f?void 0:f.toDataURL("image/png",1))}}}}var M=function(e){t.current&&(t.current.style.cursor=h?s[e]:c[e])},T=(0,r.useCallback)((function(e){if(t.current){var n=t.current.getClientRects(),r=e.clientX-n[0].x,a=e.clientY-n[0].y;if(!E.current){var c=f(g,{offsetX:r,offsetY:a});M(c)}if(w.current!==o.out){var s=function(e,t,n,r,a,i,c){var s=t.offsetX,u=t.offsetY,l=e.x,f=e.y,d=e.width,v=e.height,h=s-n.x,p=u-n.y,g=l+d,m=f+v;switch(r){case o.in:l+=h,f+=p;break;case o.top_left:if(c)break;(d=g-(l=s<0?0:s))<30&&(l=g-(d=30)),(v=m-(f=u<0?0:u))<30&&(f=m-(v=30));break;case o.top_right:if(c)break;(v-=p)<30&&(f=m-(v=30)),(f=m-v)<0&&(v=m-(f=0)),l+(d+=h)>a&&(d=a-l);break;case o.bottom_right:c&&(Math.abs(h)<Math.abs(p)?p=h:h=p),(d+=h)<30&&(d=30),(v+=p)<30&&(v=30),l+d>a&&(d=a-l),f+v>i&&(v=i-f);break;case o.bottom_left:if(c)break;(d=g-(l=s<0?0:s))<30&&(l=g-(d=30)),(v+=p)<30&&(f=m-(v=30)),f+v>i&&(v=i-f);break;case o.top:if(c)break;(v=m-(f=u<0?0:u))<30&&(f=m-(v=30));break;case o.bottom:if(c)break;(v+=p)<30&&(v=30),f+v>i&&(v=i-f);break;case o.right:if(c)break;(d+=h)<30&&(d=30),l+d>a&&(d=a-l);break;case o.left:if(c)break;(d=g-(l=s<0?0:s))<30&&(l=g-(d=30))}return l<0&&(l=0),f<0&&(f=0),l+d>a&&(l=a-d),f+v>i&&(f=i-v),{x:l,y:f,width:d,height:v}}(g,{offsetX:r,offsetY:a},b,w.current,i,l,h),u=s.x,d=s.y,v=s.width,p=s.height;x({x:r,y:a}),m({x:u,y:d,width:v,height:p}),R()}}}),[b,g]),k=(0,r.useCallback)((function(e){E.current=!1,w.current=0}),[]);return(0,r.useEffect)((function(){R()}),[]),(0,r.useEffect)((function(){return window.addEventListener("mousemove",T),window.addEventListener("mouseup",k),function(){window.removeEventListener("mousemove",T),window.removeEventListener("mouseup",k)}}),[T,k]),a().createElement("canvas",{ref:t,width:i,height:l,onMouseDown:function(e){E.current=!0;var t=e.nativeEvent,n=t.offsetX,r=t.offsetY;w.current=f(g,e.nativeEvent),M(w.current),x({x:n,y:r})},onMouseEnter:function(e){var t=e.nativeEvent;t.offsetX,t.offsetY}})},g=function(e){var t=(0,r.useRef)(null),n=e.src,o=e.canvasWidth,i=e.canvasHeight,c=e.dots,s=(0,r.useState)(function(e,t,n){for(var r=Math.min(.5*e,.5*t,200)/2,o=e/2,a=t/2,i=[],c=0;c<n;c++){var s;s=n%2==1?c/n*2*Math.PI-Math.PI/2:(c+.5)/n*2*Math.PI;var u=Math.cos(s).toFixed(3),l=Math.sin(s).toFixed(3);i.push({x:o+r*parseFloat(u),y:a+r*parseFloat(l)})}return i}(o,i,c)),l=s[0],f=s[1],v=(0,r.useRef)(e.dots),h=(0,r.useRef)(!1);function p(){if(t.current){var r=t.current.getContext("2d");if(r){r.clearRect(0,0,o,i),r.fillStyle="rgba(0,0,0,0.5)",r.beginPath(),r.lineTo(0,0);for(var a=0;a<e.dots;a++)r.lineTo(l[a].x,l[a].y);for(r.lineTo(l[0].x,l[0].y),r.lineTo(0,0),r.lineTo(0,i),r.lineTo(o,i),r.lineTo(o,0),r.fill(),r.strokeStyle="#0F0",r.fillStyle="#F40",r.beginPath(),a=0;a<e.dots;a++)r.setLineDash([5]),r.lineTo(l[a].x,l[a].y),r.fillRect(l[a].x-5,l[a].y-5,u,u);r.lineTo(l[0].x,l[0].y),r.stroke(),r.closePath();var c=document.createElement("canvas"),s=0,f=o,v=0,h=i;l.forEach((function(e){s=Math.max(s,e.x),f=Math.min(f,e.x),v=Math.max(v,e.y),h=Math.min(h,e.y)})),c.width=s-f,c.height=v-h;var p=c.getContext("2d"),g=new Image;g.setAttribute("crossOrigin","anonymous"),g.src=n||"",g.onload=function(){null==p||p.beginPath(),l.forEach((function(e){null==p||p.lineTo(e.x-f,e.y-h)})),null==p||p.lineTo(l[0].x-f,l[0].y-h),null==p||p.clip();var t=d(o,i,g.width,g.height,f,h,c.width,c.height);null==p||p.drawImage(g,t[0],t[1],t[2],t[3],0,0,c.width,c.height),e.onResult(null==c?void 0:c.toDataURL("image/png",1))}}}}(0,r.useEffect)((function(){p()}),[]),(0,r.useEffect)((function(){return window.addEventListener("mousemove",b),window.addEventListener("mouseup",x),function(){window.removeEventListener("mouseup",b),window.removeEventListener("mouseup",x)}}),[]);var g=function(n){if(t.current){var r=t.current;n===e.dots?r.style.cursor="default":r.style.cursor="move"}};function m(e,t,n){return n>e&&n<t}function y(t,n){for(var r=0;r<e.dots;r++)if(m(t[r].x-5,t[r].x+5,n.x)&&m(t[r].y-5,t[r].y+5,n.y))return r;return e.dots}var b=function(n){if(console.log(n.clientX,n.clientY),t.current){var r=t.current.getClientRects(),a=n.clientX-r[0].x,c=n.clientY-r[0].y;if(!h.current){var s=y(l,{x:a,y:c});g(s)}v.current!==e.dots&&(a<0&&(a=0),c<0&&(c=0),a>o&&(a=o),c>i&&(c=i),l[v.current]={x:a,y:c},f(l),p())}},x=function(t){h.current=!1,v.current=e.dots};return console.log(o),a().createElement("canvas",{ref:t,width:o,height:i,onMouseDown:function(e){h.current=!0;var t=e.nativeEvent,n=t.offsetX,r=t.offsetY;v.current=y(l,{x:n,y:r}),g(v.current)},onMouseEnter:function(e){var t=e.nativeEvent;t.offsetX,t.offsetY}})};var m=n(379),y=n.n(m),b=n(795),x=n.n(b),w=n(569),E=n.n(w),R=n(565),M=n.n(R),T=n(216),k=n.n(T),A=n(589),C=n.n(A),S=n(424),P={};P.styleTagTransform=C(),P.setAttributes=M(),P.insert=E().bind(null,"head"),P.domAPI=x(),P.insertStyleElement=k(),y()(S.Z,P),S.Z&&S.Z.locals&&S.Z.locals;var I=function(){return I=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},I.apply(this,arguments)};const _=function(e){var t=e.type,n=void 0===t?"rectangle":t,o=e.image,i=void 0===o?"":o,c=(0,r.useRef)(null),s=(0,r.useMemo)((function(){if(!c.current)return null;var t=c.current,r=t.clientWidth,o=t.clientHeight;console.log(r);var s={canvasWidth:r,canvasHeight:o,src:i};switch(n){case"rectangle":return a().createElement(p,I({onResult:e.onResult},s));case"square":return a().createElement(p,I({onResult:e.onResult},s,{square:!0}));case"circle":return a().createElement(h,I({onResult:e.onResult},s));case"polygon":return a().createElement(g,I({onResult:e.onResult,dots:e.nodesNum||4},s));default:throw new Error("wrong type,the type could only be circle,square,rectangle or polygon")}}),[n,i]);return a().createElement("div",{ref:c,className:"box",style:I(I({},e.style),{backgroundImage:"url(".concat(i,")")})},s)}},500:(e,t,n)=>{var r=n(883);e.exports=r}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={id:r,exports:{}};return e[r](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(500)})();
//# sourceMappingURL=index.js.map